---
title: "Itcha-Ilgachuz Caribou Herd Planning Scenarios"
author: "Kyle Lochhead, Elizabeth Kleynhans and Tyler Muhly"
date: "05/05/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require (kableExtra)
require (data.table)
require (here)
require (dplyr)
require (ggplot2)
require (scales)
require (knitr)
```

## Executive Summary
Here we report on the results of simulations of caribou critical habitat management scenarios developed to inform the Itcha-Ilgachuz caribou herd recovery plan. We compared scenarios developed by Environment and Climate Change Canada (ECCC) and British Columbia (BC) to 'business-as-usual' (BAU) scenarios in a caribou and land use simulator (CLUS). Scenarios were implemented in the CLUS as constraints on forestry developement within caribou critical habitat areas.

We used the CLUS model to simulate forest harvest and stand regeneration on a landscape 200 years into the future. From the model, we estimated future potential timber harvest, i.e., annual cut, and caribou habitat quality indicators related to forest stand age and habitat disturbance. We simulated forestry in the Quesnel and Williams Lake timber supply areas because they overlapped with the majority of the Itcha-Ilgachuz caribou herd. 

The ECCC and BC scenarios both used spatial caribou critical habitat data developed by the BC government to identify where to apply new constraints for each scenario. Critical habitat was divided into several types, including high elevation winter and summer range, low elevation winter range, low elevation summer range and matrix. Each scenario had specific limits on 'disturbance' (in this case, cutblocks and roads) applied to each habitat type.

In the modelled scenarios we considered two definitions of habitat recovery (i.e. no longer disturbed), based on age of the habitat disturbance. We considered either greater than 40 or greater than 30 year old cutblocks and roads as 'undisturbed' (i.e., recovered caribou habitat). In all scenarios, the CLUS model did not recover existing roads, but recovered roads simulated by CLUS. Foresty was simulated with different adjacency constraints, i.e., a forest stand could only be cut adjacent to a forest stand that had acheieved a specific height. We simulated scenarios with 3m and 1.5m adjacency contraints.

As expected, the BAU scenario had the highest annual timber harvest but lowest indicators of caribou habitat quality. A no harvest scenario in all critical caribou habitat had a 14% (approximately 500,000m^3^ yr^-1^) impact on timber harvest. The ECCC scenarios resulted in a 10% (approximately 350,000m^3^ yr^-1^) to 12% (approximately 400,000m^3^ yr^-1^) reduction in annual harvested volume compared to BAU scenarios. The BC herd plan scenarios resulted in a 3% (approximately 100,000m^3^ yr^-1^) to 5% (approximately 160,000m^3^ yr^-1^) reduction in annual harvested volume compared to BAU scenarios. Decreasing the habitat recovery time from 40 years to 30 years resulted in a 1% (approximately 30,000m^3^ yr^-1^) improvement in annual harvest across scenarios. The no harvest, BC herd plan and ECCC scenarios all had the desired effect of reducing the amount of disturbance and early seral forest in caribou critical habitat. The BC herd plan scenarios allowed for some disturbance and early seral forest in low elevation winter range and matrix critcal habitat, but less than in the BAU scenario, and the ECCC scenarios resulted in a decrease in disturbance and early seral forest in matrix habitat compared to the BC herd plan scenarios.

The scenario results provide a basis for evaluating the trade-off between forest harvest and caribou habitat recovery. However, they need to be evaluated within the context of the CLUS model parameters, such as habitat recovery rates and forest harvest prioritization logic. We show that reducing the time period of habitat recovery from 40 years to 30 years can reduce the impact to forest harvest. More importantly, we found that applying a 35% disturbance constraint in Itcha-Ilgachuz critical habitat would allow for little future forest harvest there, due to the already high levels of road disturbance in that area. However, we also show that some forest harvest can occur if roads are recovered. Our results show a need for careful consideration of the independent effects of roads and early seral forest on caribou populations, and for a clear definition of and plan for recovered caribou habitat to create more realistic and optimistic CLUS model scenarios and caribou recovery plans.

Finally, our results emphasize the importance of jointly managing caribou critical habitat across multiple caribou herds. Our model showed that applying critical habitat constraints exclusively to the Itcha-Ilgachuz herd displaced forestry disturbance to the critical habitat of other caribou herds in a timber supply area. Thus, we found that even herds that are not adjacent or ecologically connected are not necessarily independent in terms of forest management. The effects of independently constraining forestry in single caribou herds are unlikely to be additive, but are non-linear and compounded as more herds' habitat is protected. Ultimately, we recommend that forest harvest in caribou critical habitat is managed across multiple herds in a timber supply area. We recommend prioritizing which herds will be recovered and engaging in planning for groups of connected caribou herds as opposed to singular herd planning.  

## Introduction
Here we report on the results of simulations of caribou critical habitat management scenarios developed for the Itcha-Ilgachuz caribou herd recovery plan. We took habitat management scenarios developed by Environment and Climate Change Canada (ECCC) and British Columbia (BC) and compared them to a 'business-as-usual' (BAU) scenario in a caribou and land use simulator (CLUS). Scenarios were implemented in the CLUS as additional constraints on forestry developement within caribou critical habitat areas. Below, we decribe the general methods and key parameters implemented in the CLUS model, results of model outputs and conclusions on the implications of model outputs. 

## Methods
We used the [CLUS model](https://github.com/bcgov/clus) to simulate forest harvest and regeneration on a landscape 200 years into the future. From the model, we estimated future potential timber harvest, i.e., annual cut, and caribou habitat quality indicators. The CLUS model mirrors models developed for timber supply reviews (TSRs), but integrates them with caribou habitat models and indicators. It uses the [provincial forest inventory](https://catalogue.data.gov.bc.ca/dataset/vri-2019-forest-vegetation-composite-layer-1-l1-) and road data developed for the provincial cumulative effects program combined with [forest tenure roads](https://catalogue.data.gov.bc.ca/dataset/forest-tenure-road-segment-lines) as key inputs on the current state of the landscape. In addition, it implements existing spatial and legal constraints on forest harvest, i.e., the timber harvest land base (THLB), [government actions regulation (GAR) orders](https://www2.gov.bc.ca/gov/content/environment/natural-resource-stewardship/laws-policies-standards-guidance/legislation-regulation/forest-range-practices-act/government-actions-regulation), [visual quality objectives (VQOs)](https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/visual-resource-management), [old growth management areas (OGMAs)](https://catalogue.data.gov.bc.ca/dataset/old-growth-management-areas-legal-current) and [biodiversity emphasis options (BEOs)](https://catalogue.data.gov.bc.ca/dataset/landscape-units-of-british-columbia-all).  

CLUS is flexible in its scale. At a minimum it simulates forestry within a single timber supply area (TSA) or supply block within a TSA (i.e., where AAC partitions are spatially allocated). However, it can simulate all TSAs that overlap a caribou herd, because it applies common data and assumptions across TSAs. It is important to note that the CLUS model is not a copy of TSR models used to establish allowable annual cut (AAC). TSR models were designed to be specific for a particular AAC determination, whereas CLUS was designed to be general and flexible across TSAs. Although, these models all apply similar data, logic and assumptions, the CLUS model may differ from TSR models in some cases. Thus, CLUS model scenario outputs need to be assessed in the context of outputs from a CLUS BAU scenario, and not against a legislated AAC or other modelled timber supply scenarios (which may be constructed with a different vintage of information).

The CLUS model simulated the harvest of live trees only, and thus it may underestimate the impact of forestry on caribou where there is significant harvest of dead volume, as was the case with the mountain pine beetle uplift policies. However, the AAC uplift to harvest dead mountain pine beetle stands is reaching an end (e.g., see the current [Quesnel TSA 2017 rationale](https://www2.gov.bc.ca/assets/gov/farming-natural-resources-and-industry/forestry/stewardship/forest-analysis-inventory/tsr-annual-allowable-cut/quesnel_newsrelease_122-001246.pdf)), and thus the potential underestimate of future salvage harvest was expected to be minimal.

The CLUS model was implemented using the [R programming language](https://www.R-project.org/) and the [SpaDES](https://spades.predictiveecology.org/) R package. All code to run the model was posted to the BC government [GitHub repository](https://github.com/bcgov/clus), following all requirements and guidelines establshed by the BC government. 

### Determining the Allowable Annual Cut Target
For each TSA that overlapped the Itcha-Ilgachuz caribou herd's critical habitat, we used the CLUS model to identify an annual sustained yield (SY) of live timber volume in the unit under BAU. The SY was determined by simulating varying annual live volume harvest targets over a 200 year period and identifying the minimum target that was achievable annually over the period. This may be different then the current [legislated AAC](https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/timber-supply-review-and-allowable-annual-cut) of live volume of timber, which is determined based on multiple and often complex factors, and implemented for an approximately 10 year period. Thus, the 10 year AAC may be greater or less than what is potentially achievable over a 200 year period (i.e., given that landscapes change through time), and may not be suitable for assessing the long-term impacts of a novel forest harvest constraint on AAC. Rather, we mimic a TSR process which compares a number of scenarios to determine the potential harvest level using the most current landscape information.

Here we simulated forestry in the Quesnel and Williams Lake TSA's because they overlapped with the majority of the Itcha-Ilgachuz caribou herd. A portion of the herd occurred in the Prince George TSA, but that was not included in the analysis because of its small overlap (less than 1%).  The AAC of live volume in the [Quesnel TSA was 1,250,000m^3^ yr^-1^ in 2017](https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/timber-supply-review-and-allowable-annual-cut/allowable-annual-cut-timber-supply-areas/quesnel-tsa) and in the [Williams Lake TSA was 1,500,000m^3^  yr^-1^ in 2015](https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/timber-supply-review-and-allowable-annual-cut/allowable-annual-cut-timber-supply-areas/williams-lake-tsa). However, the live volume SY for these units was determined to be 1,660,000 m^3^ yr^-1^ in the Quesnel TSA and 1,860,000 m^3^ yr^-1^ in the Williams Lake TSA. These annual targets were implemented in all scenarios, and caribou recovery scenarios were evaluated against the BAU scenario with these targets. 

### Scenarios
We implemented three scenarios in CLUS:

1. Business as Usual

2. ECCC Recovery Strategy

3. BC Itcha-Ilgachuz Herd Plan 

The BAU scenario implemented the model with current, existing legal constraints (see above). The ECCC and BC scenarios implemented additional constraints on caribou critical habitat types (Table 1). Critical habitat areas were spatially defined by BC government caribou biologists with expertise working in the Itcha-Ilgachuz caribou herd range. Details on these constraints are described in the *Key Model Parameters*, below. 

```{r, table 1, scenarios, echo = F, error = F, eval = T, include = T, message = F}

table.scenarios = data.table(
  constraint = c ("HEWR", "HESR", "LEWR", "LESR", "Matrix", "Cutblock Recovery", "Road Recovery", "500m Buffer", "Adjacency"),
  bau = c ("No constraint", "No constraint", "No constraint", "No constraint", "No constraint", "NA", "None", "None", 
           "1.5m or 3m"),
  eccc = c ("No Disturbance", "No Disturbance", "No Disturbance", "No Disturbance", "35% Disturbance Threshold", 
                     "30 or 40 years", "None", "In all habitat types", "1.5m or 3m"),
  bc = c ("No Disturbance", "No Disturbance", "35% Disturbance Threshold", "35% Disturbance Threshold", 
                   "35% Disturbance Threshold", "30 or 40 years", "None",  "HEWR, HESR, LEWR, LESR", "1.5m or 3m")
)

kable (table.scenarios,
       caption = "<b>Table 1. Itcha-Ilgachuz Herd Plan Habitat Management Scenario Parameters.<b>",
       col.names = c("Constraint Type",
                     "BAU",
                     "ECCC Strategic Plan",
                     "BC Herd Plan")) %>%
  kable_styling (position = "left",
                 bootstrap_options = c("striped", "hover"),
                 fixed_thead = T,
                 full_width = F,
                 font_size = 11) %>%
  footnote (general = "BAU = business-as-usual scenario; ECCC = Environment and Climate Change Canada; BC = British Columbia; HEWR = high elevation winter range; HESR = high elevation summer range; LEWR = low elevation winter range; LESR = low elevation summer range",
            fixed_small_size = T)

```

### Key Model Parameters
Below we highlight some of the key parameters used in the CLUS model, as they have important implications for CLUS model outputs. Model results must be interpreted within the context of these parameters. 

#### Critical Habitat Constraint Types
The ECCC and BC scenarios both use the spatial caribou critical habitat data developed by the BC government. Critical habitat is divided into several types, including high elevation winter range (HEWR), high elevation summer range (HESR), which are grouped together in the Itcha-Ilgachuz herd range as high elevation winter and summer range (HEWSR), low elevation winter range (LEWR), low elevation summer range (LESR) and matrix. Within each of those types a constraint on 'disturbance' is applied, and there are two types of constraint thresholds: 'no disturbance' and '35% disturbance'. No disturbance areas restrict any future forestry or other types of development. The 35% disturbance threshold restricts development to 35% of the area of the critical habitat type. This threshold was selected based on a model developed by [ECCC for boreal caribou](https://www.canada.ca/en/environment-climate-change/services/species-risk-public-registry/related-information/boreal-caribou-science-summary.html). The model related disturbance, estimated as the area of non-overlapping fire and anthropogenic disturbance (e.g., cutblocks, roads, seismic lines, etc., mapped using sateliite imagery) buffered by 500m, to boreal caribou calf recruitment rate, and then this model was used to estimate the probability that a boreal caribou population trend (\( \lambda \)) is greater or equal to one as the area of disturbance changes (Fig. 1).

```{r FIG 1 lambda - disturb, echo = F, message = F, eval = T, fig.cap = "Figure 1. Modelled relationship between boreal caribou population trend and habitat disturbance. Source: https://www.canada.ca/en/environment-climate-change/services/species-risk-public-registry/related-information/boreal-caribou-science-summary.html", fig.width = 1, fig.height = 3}
knitr::include_graphics( here ("reports/scenarios/images", "eccc_lambda_disturb_fig.jpg"))
```

The [ECCC recovery strategy for southern mountain caribou](https://www.registrelep-sararegistry.gc.ca/virtual_sara/files/plans/rs_woodland_caribou_bois_s_mtn_pop_0114_e.pdf) adopted the boreal disturbance model for establishing limits to disturbance in some southern mountain caribou critical habitat types, and these were used as constraints in our scenarios (Table 1). However, there were challenges with implementing this constraint directly in our model, and therefore we developed a modified approach to using it in CLUS. Specifically, we found that disturbance levels in certain Itcha-Ilgachuz critical habitat types were greater than 35%, and much of this disturbance (e.g., roads, mines, agriculture) was not recovered in the model. In particular, roads were a key contributor to much of the disturbance. We were unable to recover these existing roads, because the roads data does not indicate road age and status. Without a detailed road recovery plan it is difficult to develop assumptions on road recovery in the model. As a consequence, constraining on 35% disturbance essentially makes it very similar to a no harvest scenario, and thus that scenario can be used to evaluate the effects of implementing a 35% disturbance constraint on forestry activity without recovery of other existing disturbance features.     

As an alternative to constraining on disturbance, we developed an approach that constrained forestry activity in such a way as to allow up to 35% disturbance from forestry in critical habitat. We used a previously developed model ( [Muhly 2016](https://www2.gov.bc.ca/assets/gov/farming-natural-resources-and-industry/forestry/stewardship/forest-analysis-inventory/tsr-annual-allowable-cut/wildlife-analysis/road_cutblock_model_20161102.pdf)) that found that an approximately 18% area of less than 40 year cutblocks in a landscape unit was equivalent to a 35% disturbance level. Thus, in scenarios that required a 35% disturbance threshold in critical habitat areas, we allowed for some forestry to occur by limiting the amount of cutblocks less than 40 years old to 18% of those areas. Further, forest harvest was prioritized to areas that were the closest to existing disturbances, thus aggregating future forest activities to areas that were already disturbed (see below).

#### Prioritization of Forest Stands for Harvest
Similar to other TSR models, the CLUS model harvested forest stands by establishing a priority harvesting queue based on stand characteristics. These characteristics included: distance to existing disturbed area (i.e., road or cutblock), stand age and stand volume. The model established which stands to harvest at each time step by first selecting those stands closest to disturbed areas, then older stands, and then high volume stands. This order is important, and is different than TSR models, which do not consider distance to disturbance when establishing a harvest priority queue. By prioritizing harvest to areas adjacent to existing disturbances, we limited the total amount of disturbance from forest harvest, which follows the intent of the disturbance constraints, and is a caribou focused approach to forest management. 

#### Road and Cutblock Disturbance and Recovery
The CLUS model simulated forestry cutblocks and roads, both of which are considered 'disturbances'. Other disturbance features (e.g., highways, mines, agriculture) were not simulated, but held constant in the model (e.g., no new mines were built and no mines were recovered in the model). In the modelled scenarios we considered two definitions of cutblock and road recovery, based on age of these disturbances, to assess the influence of their recovery time on forest harvest. In some scenarios we considered less than 40 year old cutblocks and roads as 'disturbed', and anything older as 'undisturbed' (i.e., recovered caribou habitat). In other scenarios we considered less than 30 year old cutblocks and roads as disturbed.

Cutblocks were considered undisturbed at 30 or 40 years old because these thresholds are often used as a general 'rule-of-thumb' to define a change from early to mid seral forest and lower to higher quality caribou habitat. Early seral forest stands are considered poor quality caribou habitat because they provide more forage for moose (i.e., shrubs), which can potentially increase moose and wolf density in caribou ranges, and ultimately predation on caribou (e.g., [DeCesare et al. 2010](https://zslpublications.onlinelibrary.wiley.com/doi/full/10.1111/j.1469-1795.2009.00328.x); [McLellan et al. 2010](https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/09-0286.1)). There is some evidence that moose prefer 10 to 30 year old stands in some parts of BC ( [Poole and Stuart-Smith 2004](https://www.researchgate.net/profile/Kim_Poole/publication/228974009_Winter_habitat_selection_by_moose_in_the_East_Kootenay_British_Columbia_final_report/links/55bbdc0708ae092e9660b312.pdf), [Schneideman 2018](http://web.unbc.ca/~michael/Pubs/Matt%20Scheideman%20Thesis%20Final%20for%20distribution.pdf)). In addition, a landscape model of the relationship between boreal caribou \( \lambda \) and disturbance developed in Alberta used a 30 year cutblock and fire age as a threshold to define poor caribou habtiat (see Appendix 2 of [Athabasca Landscape Team 2009](http://www.albertacariboucommittee.ca/PDF/Athabasca-Caribou.pdf)). However, the ECCC disturbance model did not assess forest stand age and caribou habitat recovery. Instead, disturbances were defined based on visual interpretation of satellite imagery. Thus, it is unknown whether a 30 or 40 year forest age threshold is appropriate for defining distturbed caribou habitat. 

In these scenarios, the CLUS model did not recover existing roads. However, because we could track the age of newly built roads in CLUS, we were able to recover those features. We applied the same recovery parameters to roads simulated in CLUS as we did to cutblocks. While there is research indicating that roads are poor habitat for caribou (e.g., [Dyer et al. 2002](https://www.nrcresearchpress.com/doi/abs/10.1139/z02-060#.XnuL1ohKiUk); [Whittington et al. 2011](https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2664.2011.02043.x); [Dussault et al. 2012](https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2012.1700)), there appears to be limited research on how road recovery might influence caribou. Much of the research on linear feature recovery has focussed on seismic lines in the boreal forest (e.g., [Dickie et al. 2016](https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2664.12732); [Finnegan et al. 2018](https://www.sciencedirect.com/science/article/pii/S0378112717318078); [Tattersall et al. 2019](https://www.sciencedirect.com/science/article/pii/S0006320719307013)). 

We tested the effect of varying the recovery age of cutblocks and roads from 30 to 40 years on model outputs. This parameter requires careful consideration based on knowledge of caribou ecology, forest stand characteristics and road reocvery as they relate to moose forage and wolf movement in the area being modelled. For example, it is important to consider the relationship between forest age and shrub cover across a diversity of forest stand types in the area of interest, as some stands will mature faster or slower than 30 or 40 years, depending on vegetation communities and site characteristics. 

#### Cutblock Adjacency
Foresty was simulated with adjacency constraints, i.e., a forest stand could only be cut adjacent to a forest stand that had acheieved a specific height. We simulated each scenario with a 3m and 1.5m  adjacency constraint. This adjacency constraint can be decreased or increased to allow more or less flexibility in where the model can harvest. 

#### Fire
The CLUS model did not simulate fire. Thus, we estimated potential fire disturbance in Itcha-Ilgachuz critical habitat with a *post-hoc* analysis. We calculated the amount of area of less than 40 year old burns in each critical habitat type over the last 40 years. We then calculated the median, minimum and maximum of those values, and used this data to estimate how much disturbance could occur from fire, in addition to forestry.  

## Results
The BAU scenario had the highest annual forest harvest, but lowest indicators of caribou habitat and survival. The ECCC recovery strategy and BC herd plan scenarios both reduced timber harvest and positively influenced caribou indicators. Detailed results on each indicator for each scenario are provided below.

### Modeled Annual Harvested Volume
A no harvest scenario in all critical caribou habitat had a 14% (approximately 500,000m^3^ yr^-1^) impact on forest harvest (Table 2). Otherwise, the ECCC scenarios had the largest impact on timber harvest, regardless of adjacency height and habitat recovery time (Table 2). The ECCC scenarios resulted in a 10% (approximately 350,000m^3^ yr^-1^) to 12% (approximately 400,000m^3^ yr^-1^) reduction in annual harvested volume compared to BAU scenarios. The BC herd plan scenarios resulted in a 3% (approximately 100,000m^3^ yr^-1^) to 5% (approximately 160,000m^3^ yr^-1^) reduction in annual harvested volume compared to BAU scenarios. Decreasing habitat recovery time from 40 years to 30 years resulted in a 1% (approximately 30,000m^3^ yr^-1^) improvement in annual harvested volume across scenarios. A 3m adjacency constraint increased the annual amount of volume harvest in the scenarios compared to a 1.5m adjacency constraint. In the BAU scenarios, the annual forest harvest decreased by 2% (approximately 60,000m^3^ yr^-1^) with the 3m adjacency constraint compared to a 1.5 m constraint. In the ECCC and BC scenarios, the annual timber harvest decreased by 3% (approximately 100,000m^3^ yr^-1^) with the 3m adjacency constraint compared to a 1.5m constraint.

```{r, table 2, results, echo = F, error = F, eval = T, include = T, message = F}
# data.harvest <- read.csv (here ("reports/scenarios/data", "harvest.csv"))
# data.summ <- data.harvest %>% # get summary data
#               filter (scenario == "itchas_nh_crit_aNA_rNA") %>%
#                   summarise (sum (volume)/40)
table.volume = data.table (
  scenario = c ("BAU", "BAU", "BC Herd Plan", "ECCC Recovery Strategy", "BC Herd Plan", "ECCC Recovery Strategy", "BAU",
                "BC Herd Plan", "ECCC Recovery Strategy", "BC Herd Plan", "ECCC Recovery Strategy", "No Harvest"),
  adjacency = c (0, 1.5, 1.5, 1.5, 1.5, 1.5, 3, 3, 3, 3, 3, 0),
  recovery = c (0, 0, 40, 40, 30, 30, 0, 40, 40, 30, 30, 0),
  annual_volume = c (3460143, 3460473, 3295942, 3035029, 3325450, 3061603, 3519953, 3394338, 3138134, 3425914, 3163968, 2959133),
  diff_annual_volume = c (0, 0, 164531, 425444, 135023, 398870, 0, 125615, 381819, 94039, 355985, 501010),
  perc_diff_tot_volume = c ("0", "0", "-5%", "-12%", "-4%", "-12%", "0", "-4%", "-11%", "-3%", "-10%", "-14%")
)
kable (table.volume,
       caption = "<b>Table 2. Annual Harvested Volume Over a 200 Year Period in the Quesnel and Williams Lake Timber Supply Areas Under Different Itcha-Ilgachuz Habitat Caribou Recovery Scenarios.<b>",
       col.names = c("Scenario",
                     "Adjacency Height Requirement (m)",
                     "Habitat Recovery Time (Years)",
                     "Average Annual Volume (m3)",
                     "Difference in Annual Volume (m3)",
                     "Percent Difference in Annual Volume"),
       format.args = list (big.mark = ","),
       align = rep( c('l', 'c', 'c', 'c', 'c', 'c'))) %>%
  kable_styling (position = "left",
                 bootstrap_options = c("striped", "hover"),
                 fixed_thead = T,
                 full_width = F,
                 font_size = 11) %>%
  footnote (general = "BAU = business-as-usual scenario; ECCC = Environment and Climate Change Canada; BC = British Columbia",
            fixed_small_size = T)
```

### Actual Annual Harvested Volume
Recent billed harvest in the Quesnel and Williams Lake TSA's has been below the current live and dead stand AAC in those units (Fig. 2). Annual harvest in 2019 was at approximately 58% and 54% of the AAC in the Williams Lake and Quesnel TSA's, respectively. Much of this decline may be due to a reduction in harvest of dead stands, as the majority of mountain pine beetle killed stands may have already been harvested. However, it is worth noting that recently the AAC was not being achieved in these TSAs.  

```{r, FIG 2, harvest actual, echo = F, error = F, eval = T, include = T, message = F}
data.harvest <- read.csv (here ("reports/scenarios/data", "volume_actual_itcha_scenario_March2020.csv"))
data.harvest <- data.harvest %>%
                  filter (SCALE_YEAR > 2016)
ggplot (data.harvest, aes (x = SCALE_YEAR, y = volume_m3)) +
  geom_point () + 
  geom_line () +  
  # geom_smooth () + 
  facet_grid (. ~TFL_TSA_NAME) +
  labs (title = "Figure 2. Actual Volume of Timber Harvest Billed in the Quesnel and 
Williams Lake TSA's", 
        x = "Year", 
        y = "Billed Volume (m3)",
        caption = "Quesnel AAC = 2,607,000m3                                         Williams Lake AAC = 3,000,000") +
  scale_y_continuous (labels = comma,
                      breaks = seq (1500000, 2500000, by = 500000)) +
  scale_x_continuous (breaks = seq (2017, 2019, by = 1))

```

### Disturbance Indicator
Below we summarize the disturbance indicator outputs from the CLUS model under the alternative scenarios. These indicate the area of critical habitat in each TSA that is 500m from roads and cutblocks. Note that here we summarize the outputs from the model scenarios with a 3m adjacency constraint, as the results are essentially the same for scenarios with 1.5m adjacency. 

#### Disturbance in Itcha-Ilgachuz Critical Habitat in the Quesnel TSA
The no harvest, BC herd plan and ECCC scenarios all reduced the amount of disturbance in caribou critical habitat compared to the BAU scenarios in the Quesnel TSA (Fig. 3). The no harvest scenario resulted in the lowest levels of disturbance over the simulation period, remaining steady in all high and low elevation critical habitat types over the first 150 years of the simulation, and then declining slightly thereafter. In addition, in the no harvest scenario the amount of disturbance in matrix critical habitat decreased steadily over the first 25 years of the simulation, stabilized, and then declined sharply at year 150. Thus, the no harvest scenario was succesfull at reducing disturbance in caribou critical habitat. However, notably in matrix habitat a disturbance threshold less than 50% was never achieved over a 200 year period. All scenarios, including BAU were successfull at maintaining stable disturbance levels in HEWSR, and only the BAU scenario resulted in increasing levels of disturbance in LESR. The BC herd plan scenarios allowed for an increase in disturbance in LEWR, although less than the BAU, and the ECCC scenarios resulted in a stable level of disturbance in LEWR. Decreasing the habitat recovery period from 30 years to 40 years decreased disturbance in BC and ECCC scenarios by approximately 1% to 5%. 

```{r, FIG 3, Quesnel disturbance scenario compare, echo = F, error = F, eval = T, include = T, message = F, warning = F}
data.dist <- read.csv (here ("reports/scenarios/data", "disturbance.csv"))
data.dist <- data.dist %>%
              filter (scenario == "itchas_bau_a3_rNA" | scenario == "itchas_bc_herd_plan_a3_r40" | 
                      scenario == "itchas_eccc_a3_r40" | scenario == "itchas_bc_herd_plan_a3_r30" |
                      scenario == "itchas_eccc_a3_r30" | scenario == "itchas_nh_crit_aNA_rNA") %>%
              filter (critical_hab == "Itcha-Ilgachuz HEWSR" | critical_hab == "Itcha-Ilgachuz LESR" |
                      critical_hab == "Itcha-Ilgachuz LEWR" | critical_hab == "Itcha-Ilgachuz Matrix")
data.dist.ques <- data.dist %>%
                    filter (compartment == "Quesnel_TSA")
ggplot (data.dist.ques, aes (x = timeperiod, y = dist500_per, color = scenario, linetype = scenario)) +
  geom_line (position = position_dodge (width = 1)) + 
  facet_grid (. ~critical_hab) +
  labs (title = "Figure 3. Proportion of Area Disturbed in Itcha-Ilgachuz Critical Habitat 
in the Quesnel TSA Under the Different Habitat Management Scenarios.", 
        x = "Future Year", 
        y = "Percent Disturbed",
        caption = "BAU = business-as-usual scenario; 
ECCC = Environment and Climate Change Canada; 
BC = British Columbia") + 
  scale_color_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  scale_linetype_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  theme (legend.position = c (0.15, 0.75),
         legend.title = element_text(size = 10),
         legend.text = element_text( size = 8))
```

#### Disturbance in Itcha-Ilgachuz Critical Habitat in the Williams Lake TSA
The no harvest, BC herd plan and ECCC scenarios all reduced the amount of disturbance in caribou critical habitat compared to the BAU scenarios in the Williams Lake TSA (Fig. 4). In addition, all management scenarios reduced disturbance levels in HEWSR and LESR to at or below 35%, and they reduced disturbance in LEWR. Notably, none of the scenarios reduced disturbance in LEWR or matrix habitat to less than 35%. 

```{r, FIG 4, Williams Lake disturbance scenario compare, echo = F, error = F, eval = T, include = T, message = F, warning = F}
data.dist <- read.csv (here ("reports/scenarios/data", "disturbance.csv"))
data.dist <- data.dist %>%
              filter (scenario == "itchas_bau_a3_rNA" | scenario == "itchas_bc_herd_plan_a3_r40" | 
                      scenario == "itchas_eccc_a3_r40" | scenario == "itchas_bc_herd_plan_a3_r30" |
                      scenario == "itchas_eccc_a3_r30" | scenario == "itchas_nh_crit_aNA_rNA") %>%
              filter (critical_hab == "Itcha-Ilgachuz HEWSR" | critical_hab == "Itcha-Ilgachuz LESR" |
                      critical_hab == "Itcha-Ilgachuz LEWR" | critical_hab == "Itcha-Ilgachuz Matrix")
data.dist.wl <- data.dist %>%
                    filter (compartment == "Williams_Lake_TSA")
ggplot (data.dist.wl, aes (x = timeperiod, y = dist500_per, color = scenario, linetype = scenario)) +
  geom_line (position = position_dodge (width = 1)) + 
  facet_grid (. ~critical_hab) +
  labs (title = "Figure 4. Proportion of Area Disturbed in Itcha-Ilgachuz Critical Habitat 
in the Williams Lake TSA Under the Different Habitat Management Scenarios.", 
        x = "Future Year", 
        y = "Percent Disturbed",
        caption = "BAU = business-as-usual scenario; 
ECCC = Environment and Climate Change Canada; 
BC = British Columbia") + 
  scale_color_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  scale_linetype_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  theme (legend.position = c (0.87, 0.25),
         legend.title = element_text(size = 10),
         legend.text = element_text( size = 8))
```

#### Disturbance in Barkerville Critical Habitat in the Quesnel TSA
Putting disturbance constraints on Itcha-Ilgachuz critical habitat resulted in displacement of forest disturbance to other caribou herds' critical habitat without those constraints. For example, in the Quesnel TSA, disturbance increased in the Barkerville matrix and Wells Gray North HEWSR and matrix habitat in the Itcha-Ilgachuz habitat recovery scenarios (Fig. 5). Specifically, disturbance increased to 100% in matrix habitat within the next 100 years, and up to 50% in Wells Gray North HEWSR habitat within 50 years under all scenarios. In addition, these increases happened sooner under the Itcha-Ilgachuz critical habitat scenarios compared to the BAU scenario. 

```{r, FIG 5, Quesnel disturbance other herds, echo = F, error = F, eval = T, include = T, message = F, warning = F}
data.dist <- read.csv (here ("reports/scenarios/data", "disturbance.csv"))
data.dist <- data.dist %>%
              filter (scenario == "itchas_bau_a3_rNA" | scenario == "itchas_bc_herd_plan_a3_r40" | 
                      scenario == "itchas_eccc_a3_r40" | scenario == "itchas_bc_herd_plan_a3_r30" |
                      scenario == "itchas_eccc_a3_r30" | scenario == "itchas_nh_crit_aNA_rNA") %>%
              filter (critical_hab == "Barkerville HEWSR " | critical_hab == "Barkerville Matrix" |
                      critical_hab == "Wells Gray North HEWSR" | critical_hab == "Wells Gray North Matrix")
data.dist.ques <- data.dist %>%
                    filter (compartment == "Quesnel_TSA")
ggplot (data.dist.ques, aes (x = timeperiod, y = dist500_per, color = scenario, linetype = scenario)) +
  geom_line (position = position_dodge (width = 1)) + 
  facet_grid (. ~critical_hab) +
  labs (title = "Figure 5. Proportion of Area Disturbed in Barkerville and 
Wells Gray North Critical Habitat in the Quesnel TSA Under the 
Different Itcha-Ilgachuz Habitat Management Scenarios.", 
        x = "Future Year", 
        y = "Percent Disturbed",
        caption = "BAU = business-as-usual scenario; 
ECCC = Environment and Climate Change Canada; 
BC = British Columbia") + 
  scale_color_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  scale_linetype_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  theme (legend.position = c (0.85, 0.37),
         legend.title = element_text(size = 10),
         legend.text = element_text( size = 8))
```

### Early Seral Forest Indicator
Below we summarize the early seral forest (i.e., less than 40 year old forest stand) indicator outputs from the CLUS model under the alternative habitat management scenarios. These indicate the area of critical habitat in each TSA that is less than 40 year old forest. Note that here we summarize the outputs from the model scenarios with a 3m adjacency constraint, as the results are essentially the same for scenarios with 1.5m adjacency. 

#### Early Seral Forest in Itcha-Ilgachuz Critical Habitat in the Quesnel TSA
In the Quesnel TSA, the BAU scenario resulted in increased proportions of early seral forest habitat in LESR and LEWR critical habitat, but not HEWSR or Matrix habitat (Fig. 6). All caribou critical habitat management scenarios reduced or maintained very low proportions of early seral forest in HEWSR, LESR, LEWR and matrix critical habitat. The BC herd plan scenarios allowed for some disturbance in LEWR critcal habtiat, but approximately 5% to 15% less than in the BAU scenario. The ECCC scenarios resulted in an approximately 10% to 15% decrease in early seral forest in matrix habitat compared to the BC herd plan scenarios.

```{r, FIG 6, Area LT40 Quesnel scenario compare, echo = F, error = F, eval = T, include = T, message = F, warning = F}
data.surv <- read.csv (here ("reports/scenarios/data", "survival.csv"))
data.surv <- data.surv %>%
              filter (scenario == "itchas_bau_a3_rNA" | scenario == "itchas_bc_herd_plan_a3_r40" | 
                      scenario == "itchas_eccc_a3_r40" | scenario == "itchas_bc_herd_plan_a3_r30" |
                      scenario == "itchas_eccc_a3_r30" | scenario == "itchas_nh_crit_aNA_rNA") %>%
              filter (herd_bounds == "Itcha-Ilgachuz HEWSR" | herd_bounds == "Itcha-Ilgachuz LESR" |
                      herd_bounds == "Itcha-Ilgachuz LEWR" | herd_bounds == "Itcha-Ilgachuz Matrix")
data.surv.ques <- data.surv %>%
                    filter (compartment == "Quesnel_TSA")
ggplot (data.surv.ques, aes (x = timeperiod, y = prop_age, color = scenario)) +
  geom_line (position = position_dodge (width = 1)) + 
  facet_grid (. ~herd_bounds) +
  labs (title = "Figure 6. Proportion of Area of Less Than 40 Year Old Forest Stands in Itcha-Ilgachuz Critical Habitat 
in the Quesnel TSA Under Different Habitat Management Scenarios.", 
        x = "Future Year", 
        y = "Proportion Less Than 40 Year Old Forest",
        caption = "BAU = business-as-usual scenario; 
ECCC = Environment and Climate Change Canada; 
BC = British Columbia") + 
  scale_color_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  scale_linetype_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest"))  +
  theme (legend.position = c (0.12, 0.67),
         legend.title = element_text(size = 10),
         legend.text = element_text( size = 8))
```

#### Early Seral Forest in Itcha-Ilgachuz Critical Habitat in the Williams Lake TSA
In the Williams Lake TSA, the BAU scenario resulted in increased proportions of early seral forest habitat in HEWSR and LESR critical habitat (Fig. 7). The ECCC scenarios resulted in less than 5% early seral forest in matrix habitat. The BC herd plan sceanrios resulted in less than 5% early seral forest in LEWR habitat and less than 15% early seral forest in Matrix habitat. The amount of early seral forest in each critical habitat type in this TSA was highly cyclical. 

```{r, FIG 7, Area LT40 Williams Lake  scenario compare, echo = F, error = F, eval = T, include = T, message = F, warning = F}
data.surv <- read.csv (here ("reports/scenarios/data", "survival.csv"))
data.surv <- data.surv %>%
              filter (scenario == "itchas_bau_a3_rNA" | scenario == "itchas_bc_herd_plan_a3_r40" | 
                      scenario == "itchas_eccc_a3_r40" | scenario == "itchas_bc_herd_plan_a3_r30" |
                      scenario == "itchas_eccc_a3_r30" | scenario == "itchas_nh_crit_aNA_rNA") %>%
              filter (herd_bounds == "Itcha-Ilgachuz HEWSR" | herd_bounds == "Itcha-Ilgachuz LESR" |
                      herd_bounds == "Itcha-Ilgachuz LEWR" | herd_bounds == "Itcha-Ilgachuz Matrix")
data.surv.wl <- data.surv %>%
                    filter (compartment == "Williams_Lake_TSA")
ggplot (data.surv.wl, aes (x = timeperiod, y = prop_age, color = scenario, linetype = scenario)) +
  geom_line (position = position_dodge (width = 1)) + 
  facet_grid (. ~herd_bounds) +
  labs (title = "Figure 7. Proportion of Area of Less Than 40 Year Old Forest Stands in 
Itcha-Ilgachuz Critical Habitat in the Williams Lake TSA Under Different Habitat 
Management Scenarios.", 
        x = "Future Year", 
        y = "Proportion Less Than 40 Year Old Forest",
        caption = "BAU = business-as-usual scenario; 
ECCC = Environment and Climate Change Canada; 
BC = British Columbia") + 
  scale_color_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest")) +
  scale_linetype_discrete (name = "Scenario", labels = c("BAU, 3m, 40 years", "BC Herd Plan, 3m, 30 years", 
                                                      "BC Herd Plan, 3m, 40 years", "ECCC, 3m, 30 years",
                                                      "ECCC, 3m, 40 years", "No Harvest"))  +
  theme (#legend.position = c (0.12, 0.67),
         legend.title = element_text(size = 10),
         legend.text = element_text( size = 8))
```

### Fire
We found that the average area of less than 40 year old burns in each caribou critical habitat type was low, i.e., up to 2,000 ha or 1% of the critical habitat area (Table 3). However, burns were an episodic event, and in some years the percentatge of area of less than 40 year old burns was much larger, i.e., up to 6% in HEWSR, 14% in LEWR, 18% in LESR and 36% in matrix habitat. On average fire disturbance was low, but periodic fire events significantly increased the area disturbed in a short period of time.

```{r, table 3, fire, echo = F, error = F, eval = T, include = T, message = F, warning = F}
table.fire = data.table(
  habiat_type = c ("HEWSR",  "LEWR", "LESR", "Matrix"),
  med_area_ha = c (1208, 213, 2009, 137),
  max_area_ha = c (9029, 101034, 38829, 314797),
  min_area_ha = c ("2", "<1", "1", "<1"),
  med_perc = c ("1", "<1", "1", "<1"),
  max_perc = c (6, 14, 18, 36),
  min_prec = c ("<1", "<1", "<1", "<1")
)

kable (table.fire,
       caption = "<b>Table 3. Area Burned in a 40 Year Period in Itcha-Ilgachuz Caribou Herd Critical Habitat Types.<b>",
       col.names = c("Habitat Type",
                     "Average Area (ha)",
                     "Maximum Area (ha)",
                     "Minimum Area (ha)",
                     "Average Percent Area",
                     "Maximum Percent Area",
                     "Minimum Percent Area"),
       format.args = list (big.mark = ","),
       align = rep( c('l', 'c', 'c', 'c', 'c', 'c', 'c'))) %>%
  kable_styling (position = "left",
                 bootstrap_options = c("striped", "hover"),
                 fixed_thead = T,
                 full_width = F,
                 font_size = 11) %>%
  footnote (general = "HEWSR = high elevation winter and summer range; LEWR = low elevation winter range; LESR = low elevation summer range",
            fixed_small_size = T)
```

Our approach to estimating fire disturbance was simplistic but informative. Fire histories across caribou herds and critical habitat types indicated that fire was highly cyclical. In general, there was a period of relatively regular and large fires in the early 1900's, until the 1960's or 1970's, at which point the frequency and size of fires decreased, perhaps as fire suppresion became more effective. Thus, the area of less than 40 year old burns was declining over recent decades. However, more recently, in some caribou ranges, including the Itcha-Ilgachuz, there were large fires, suddenly increasing the amount of disturbance in caribou critical habitat types. Two important considerations with our approach are that we estimated the area of fire disturbance using burn perimeters, which likely included unburned areas, and we did not calculate fire disturbance exclusive of other overlapping disturbance types (e.g., cublocks). Thus, we likely overestimated the area burned in each critical habitat type. Future work on CLUS will improve how fire is accounted for and simulated. 

## Conclusions
We found that compared to a BAU scenario, the BC herd plan and ECCC recovery strategy scenarios reduced annual harvest in the CLUS model by up to approximately 500,000m^3^ yr^-1, or 15% of the sustained yield of the TSAs. However, as expected, the BC herd plan scenarios had a significantly smaller impact (approximately 150,000m^3^ yr^-1^) than the ECCC scenarios. These scenarios also had the desired effect of reducing the amount of disturbance and early seral forest in the Itcha-Ilgachuz critical habitat types, and as expected, the ECCC scenarios resulted in the least amount of disturbance and early seral forest in critical habitat. Scenario results further emphasized the importance of matrix habitat management to forestry. These scenarios provide a basis for evaluating the trade-off between forest harvest and caribou habitat recovery and conservation. However, they need to be evaluated within the context of CLUS model parameters, such as habitat recovery rates and forest harvest priority.    

Our results also show the significant effect of caribou habitat recovery on forest harvest rates. We show that reducing the time period of habitat recovery from 40 years to 30 years can reduce the impact to forest harvest. However, more importantly, we show that applying disturbance constraints in the Itcha-Ilgachuz herd would result in no harvest there, unless active habitat recovery were to also occur. Existing disturbances, particularly the road network, need to be recovered in many low elevation and matrix critical habitat areas to achieve 35% disturbance, regardless of future forestry activity. We show that forest harvest can occur if these disturbances are recovered. With regards to our simulation model, we suggest that it is more useful to constrain the amount of early seral forest in caribou habitat rather than disturbance to evaluate the effects of caribou habitat management on forestry.  The disturbance metric does not distinguish between the effects of roads and cutblocks on caribou, or different forest stand recovery trajectories on moose forage. Our results show that a more detailed discussion on the effects of roads and early seral forest on caribou populations, and a definition of recovered caribou habitat are both needed to create more realistic and optimistic CLUS model scenarios and caribou recovery plans.

Our results also emphasize the importance of managing caribou critical habitat at large scales. We found that applying critical habitat constraints exclusively to the Itcha-Ilgachuz herd displaced disturbance to the critical habitat of other caribou herds in a TSA. Thus, even herds that are not adjacent or ecologically connected are not necessarily independent in terms of forest management. The effects of constraining forestry in a specific caribou herd's habitat is unlikely to be additive, but is non-linear and compounded as more herds are protected. Ultimately, forest harvest in caribou critical habitat should be managed across multiple herds in the same TSA. We recommend priortizing which herds will be recovered prior to engaging in herd plannning, and in conducting planning for groups of caribou herds rather than single herds.  
